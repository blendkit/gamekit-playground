<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
    <head>
        <title>Examples and tutorials.</title>
        <link rel="stylesheet" type="text/css" href="style.css"/>
            </head>
    <body>
            <table class="tableMenu" border="0" cellspacing="0" cellpadding="0">
                <tr>
                    <td hlign="left" valign="middle" class="left">
                        <h2>
                        <a href="index.html">[OgreKit Lua]</a>
                        </h2>
                    </td>
                    <td hlign="right" valign="top" hlign="right" class="right">
                        <ul>
                            <li><a href="file_8lua.html">Files</a></li>
                            <li><a href="annotated.html">Classes</a></li>
                            <li><a href="hierarchy.html">Hierarchy</a></li>
                            <li><a href="_examples.html">Examples</a></li>
                            <li><a href="_about.html">About</a></li>
                        </ul>
                    </td>
                </tr>
            </table>
        <!-- Generated by Doxygen 1.8.7 -->
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Examples and tutorials. </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><hr/>
<table  class="nav" cellspacing="0" cellpadding="0">
<tr>
<td class="left"><a class="el" href="_examples.html#Setup">Setup for a stand alone application</a></td><td></td></tr>
<tr>
<td class="left"><a class="el" href="_examples.html#OnInit">Setup for an embedded application</a></td><td></td></tr>
<tr>
<td class="left"><a class="el" href="_examples.html#CDefs">Custom User defined variables.</a></td><td></td></tr>
<tr>
<td class="left"><a class="el" href="_examples.html#CArrayIter">Using arrays and iterators.</a></td><td></td></tr>
<tr>
<td class="left"><a class="el" href="_examples.html#CustomLogicBricks">Adding custom logic brick callbacks.</a></td><td></td></tr>
</table>
<p><br />
</p>
<h1><a class="anchor" id="Setup"></a>
Setup for a stand alone application</h1>
<p>An example showing how to set up the OgreKit <a class="el" href="class_engine.html">Engine</a>, and load a .blend. </p><div class="fragment"><div class="line">-- Extend the engine.</div>
<div class="line">OgreKitApp = <a class="code" href="_class_8lua.html#a64bb2a470effb6baaaf16df36add3e8c">BaseClass</a>(OgreKit.Engine)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">function <a class="code" href="_test0_8lua.html#a1500a0ae548abf84f48a50412cfab549">OgreKitApp</a>:<a class="code" href="_on_init_8lua.html#ada2906eee6e5af8364232f838a6f66ee">constructor</a>()</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    self.prefs              = self:getUserDefs()</div>
<div class="line">    self.prefs.winTitle     = &quot;<a class="code" href="class_engine.html">Engine</a> Setup&quot;</div>
<div class="line">    self.prefs.verbose      = false</div>
<div class="line">    self.prefs.grabInput    = false</div>
<div class="line">    self.prefs.blenderMat   = true</div>
<div class="line">    self.prefs.debugFps     = true</div>
<div class="line">    self.keyboard           = OgreKit.<a class="code" href="class_keyboard.html">Keyboard</a>()</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    -- <a class="code" href="___async_dispatcher_8lua.html#a793abedd5a6ad88bed9ce724fef5f47c">call</a> internal engine setup.</div>
<div class="line">    self:<a class="code" href="_01__miscnodes__bak_8lua.html#a5d733fdc892bb5d21f71cf0fb6f4c8da">initialize</a>()</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    -- Loads the <a class="code" href="__underscore_8lua.html#a6811066cc19fd77679992c4bc1ba6841">first</a> <a class="code" href="__blender_server_8lua.html#a875c09064c40e58287c5e8ede4dac84c">scene</a>, or the active one.</div>
<div class="line">    self.scene = self:loadBlendFile(&quot;Test0.blend&quot;)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    -- Converts blender <a class="code" href="smtp_8lua.html#af1032329b12e05aa85fc2807d1788862">data</a> to Ogre. </div>
<div class="line">    self.scene:<a class="code" href="_01__miscnodes__bak_8lua.html#a5d733fdc892bb5d21f71cf0fb6f4c8da">initialize</a>()</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    -- We now have access to <a class="code" href="ltn12_8lua.html#a01ba974fe1a240152dc17f486855f60a">all</a> the objects within the OgreKit scene. </div>
<div class="line"></div>
<div class="line">    -- Grab the default cube.</div>
<div class="line">    self.<span class="keywordtype">object</span> = self.scene:getObject(&quot;Cube&quot;)</div>
<div class="line">end</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">--- <a class="code" href="class_engine.html">Engine</a> tick listener.</div>
<div class="line">function <a class="code" href="_test0_8lua.html#a1500a0ae548abf84f48a50412cfab549">OgreKitApp</a>:<a class="code" href="_test0_8lua.html#a1dd5460becb643639f817695a28f4549">OnTick</a>(delta)</div>
<div class="line"></div>
<div class="line">    if self.keyboard:isKeyDown(OgreKit.KC_ESCKEY) then</div>
<div class="line">        self:requestExit()</div>
<div class="line">    end</div>
<div class="line"></div>
<div class="line">    self.<span class="keywordtype">object</span>:rotate(0, 0, -90 * delta)</div>
<div class="line"></div>
<div class="line">end</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">-- Create the application.</div>
<div class="line">local <a class="code" href="_test0_8lua.html#a0cd8c796fb9b31b5c536dc82211f6126">app</a> = <a class="code" href="_test0_8lua.html#a1500a0ae548abf84f48a50412cfab549">OgreKitApp</a>()</div>
<div class="line"></div>
<div class="line">-- Connect Events</div>
<div class="line"><a class="code" href="_test0_8lua.html#a0cd8c796fb9b31b5c536dc82211f6126">app</a>:<a class="code" href="tp_8lua.html#acd93284e4790b3b14977f1cc616db7c1">connect</a>(OgreKit.<a class="code" href="gs_core_8h.html#a1af68bbee43a4c1822489898e533afafa12323e7c7c825affb7e1924829f60556">EVT_TICK</a>, <a class="code" href="_test0_8lua.html#a0cd8c796fb9b31b5c536dc82211f6126">app</a>, <a class="code" href="_test0_8lua.html#a1500a0ae548abf84f48a50412cfab549">OgreKitApp</a>.<a class="code" href="_test0_8lua.html#a1dd5460becb643639f817695a28f4549">OnTick</a>)</div>
<div class="line"></div>
<div class="line">-- Start the main loop.</div>
<div class="line">app:run()</div>
<div class="line"></div>
</div><!-- fragment --><p><br />
 </p><hr/>
<h1><a class="anchor" id="OnInit"></a>
Setup for an embedded application</h1>
<p>Setup from inside blender takes place in a predefined text block named <b><a class="el" href="_on_init_8lua.html">OnInit.lua</a></b> <br />
This script will execute every time the scene is loaded.<br />
 Scripts may still span multiple text files using the standard Blender game engine method. By attaching to a Python controller.<em> <a class="el" href="class_script_controller.html">ScriptController</a> </em></p>
<div class="fragment"><div class="line"><a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a> = <a class="code" href="_class_8lua.html#a64bb2a470effb6baaaf16df36add3e8c">BaseClass</a>(OgreKit.Engine)</div>
<div class="line"></div>
<div class="line">function <a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a>:<a class="code" href="_on_init_8lua.html#ada2906eee6e5af8364232f838a6f66ee">constructor</a>()</div>
<div class="line"></div>
<div class="line">    self.scene = self:<a class="code" href="gs_core_8h.html#a62565e223df95f96b7e55da0b02ce5e0">getActiveScene</a>()</div>
<div class="line"></div>
<div class="line">end</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">function <a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a>:<a class="code" href="_on_init_8lua.html#a5d9a51e14f60a402cb7510eba4cc6201">OnUpdate</a>(delta)</div>
<div class="line"></div>
<div class="line">          OgreKit.<a class="code" href="class_debug_print.html">DebugPrint</a>(&quot;<a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a> main loop running ==&gt; &quot; .. self.scene:<a class="code" href="___async_dispatcher_8lua.html#a5b37f0b8e9f24f7b06cc5873ffa5a78c">getName</a>())</div>
<div class="line"></div>
<div class="line">end</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><a class="code" href="_on_init_8lua.html#ac514c91e4ed341f263e458d44b3bb0a7">demo</a> = <a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a>()</div>
<div class="line"><a class="code" href="_on_init_8lua.html#ac514c91e4ed341f263e458d44b3bb0a7">demo</a>:<a class="code" href="tp_8lua.html#acd93284e4790b3b14977f1cc616db7c1">connect</a>(OgreKit.EVT_TICK, <a class="code" href="_on_init_8lua.html#ac514c91e4ed341f263e458d44b3bb0a7">demo</a>, <a class="code" href="_on_init_8lua.html#aee6aa8565f29397f3cdc22bf15ba6763">Demo</a>.<a class="code" href="_on_init_8lua.html#a5d9a51e14f60a402cb7510eba4cc6201">OnUpdate</a>)</div>
</div><!-- fragment --><p><br />
 </p><hr/>
<h1><a class="anchor" id="CDefs"></a>
Custom User defined variables.</h1>
<p>This shows a simple way to add custom properties to <a class="el" href="class_user_defs.html">UserDefs</a>. </p><div class="fragment"><div class="line">local engine = OgreKit.Engine()</div>
<div class="line">local prefs  = engine:getUserDefs()</div>
<div class="line"></div>
<div class="line">local custom = OgreKit.<a class="code" href="class_property.html">Property</a>(&quot;Custom&quot;, &quot;Hello World&quot;)</div>
<div class="line">prefs:addProperty(custom)</div>
<div class="line"></div>
<div class="line">print(prefs.Custom)</div>
</div><!-- fragment --><p> <br />
 </p><hr/>
<h1><a class="anchor" id="CArrayIter"></a>
Using arrays and iterators.</h1>
<p>Example array and iterator usage</p>
<div class="fragment"><div class="line">local objects = OgreKit.ObjectList()</div>
<div class="line">objects:<a class="code" href="__underscore_8lua.html#a6bb8d87e7709362c1bb5eca94f5d7be5">push</a>(scene:getObject(<span class="stringliteral">&quot;Cube&quot;</span>))</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">local <a class="code" href="__underscore_8lua.html#a8f49e143ac5c812b54c93d0a5e5f1b02">iter</a> = objects:iterator()</div>
<div class="line">while (<a class="code" href="__underscore_8lua.html#a8f49e143ac5c812b54c93d0a5e5f1b02">iter</a>:hasMoreElements()) <a class="code" href="logging_8lua.html#af3a04dc599da50e45ea0bf4900865a25">do</a></div>
<div class="line">    local obj = <a class="code" href="__underscore_8lua.html#a8f49e143ac5c812b54c93d0a5e5f1b02">iter</a>:getNext()</div>
<div class="line"></div>
<div class="line">    <a class="code" href="classd_printf.html">dPrintf</a>(&quot;%s, %s&quot;, obj:<a class="code" href="___async_dispatcher_8lua.html#a5b37f0b8e9f24f7b06cc5873ffa5a78c">getName</a>(), <a class="code" href="logging_8lua.html#a1ba55075a1e5fbec91bce9c99e07ea46">tostring</a>(obj:getWorldPosition()))</div>
<div class="line">end</div>
</div><!-- fragment --><p><br />
 </p><hr/>
<h1><a class="anchor" id="CustomLogicBricks"></a>
Adding custom logic brick callbacks.</h1>
<p>This shows one way to add custom callbacks on logic bricks. The example here shows usage for sensors, but the method applies to controllers and actuators.</p>
<div class="fragment"><div class="line">--- Get logic manager</div>
<div class="line">logicManager = OgreKit.LogicManager()</div>
<div class="line"></div>
<div class="line">player = scene:getObject(<span class="stringliteral">&quot;Cube&quot;</span>)</div>
<div class="line"></div>
<div class="line">logicPlayer = logicManager:newObject(player)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">--- <a class="code" href="class_sensor.html">Sensor</a></div>
<div class="line"></div>
<div class="line">delay = OgreKit.<a class="code" href="class_delay_sensor.html">DelaySensor</a>(logicPlayer)</div>
<div class="line">delay:setDelay(20)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">--- <a class="code" href="class_controller.html">Controller</a></div>
<div class="line"></div>
<div class="line">operator = OgreKit.<a class="code" href="class_logic_op_controller.html">LogicOpController</a>(logicPlayer)</div>
<div class="line">operator:setOp(OgreKit.<a class="code" href="gs_bricks_8h.html#a7f074d9baa3eddd605b60fd9035ceecfa8d05c5ceb5a65bd7ffdf5062fa502b29">LOP_AND</a>)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">--- <a class="code" href="class_actuator.html">Actuator</a></div>
<div class="line"></div>
<div class="line">motion = OgreKit.<a class="code" href="class_motion_actuator.html">MotionActuator</a>(logicPlayer)</div>
<div class="line">motion:setRotation(0.0, 0.0, 0.15, true)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">--- Connect links</div>
<div class="line"></div>
<div class="line">operator:link(delay)</div>
<div class="line">operator:link(motion)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">-- Add callbacks</div>
<div class="line"></div>
<div class="line">DelayCallback = <a class="code" href="class_class.html">Class</a>()</div>
<div class="line">function DelayCallback:<a class="code" href="_on_init_8lua.html#ada2906eee6e5af8364232f838a6f66ee">constructor</a>(sensor)</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    sensor:<a class="code" href="tp_8lua.html#acd93284e4790b3b14977f1cc616db7c1">connect</a>(OgreKit.<a class="code" href="gs_bricks_8h.html#a3c2c1d6029fdcd572a5ca953cf462718a1e711fd52446d58174f0d5e130e76024">LM_EVT_OVERIDE</a>, self, DelayCallback.OnQuery)</div>
<div class="line"></div>
<div class="line">    self.maxDelay = sensor:getDelay()</div>
<div class="line">    self.incrment = 0</div>
<div class="line">    self.len = self.maxDelay</div>
<div class="line"></div>
<div class="line">end</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">function DelayCallback:OnQuery()</div>
<div class="line"></div>
<div class="line">    -- <a class="code" href="logging_8lua.html#af3a04dc599da50e45ea0bf4900865a25">do</a> tests</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    if (self.incrment &gt; self.maxDelay) then</div>
<div class="line">        if (self.incrment &gt; self.len * 2) then</div>
<div class="line">            self.incrment = 0</div>
<div class="line">        else</div>
<div class="line">            self.incrment = self.incrment + 1</div>
<div class="line">        end</div>
<div class="line"></div>
<div class="line">        return true</div>
<div class="line">    end</div>
<div class="line"></div>
<div class="line">    self.incrment = self.incrment + 1</div>
<div class="line">    return false</div>
<div class="line">end</div>
<div class="line"></div>
<div class="line">callback = DelayCallback(delay)</div>
</div><!-- fragment --><p><br />
 </p><hr/>
 </div></div><!-- contents -->
            </div>
        </div>
        <br />
        <br />
        <div id="footer">
            <hr />
            <center>
            <p> <small>Generated By Doxygen(1.8.7)</small>
            </p>
            </center>
        </div>
    </body>
</html>
